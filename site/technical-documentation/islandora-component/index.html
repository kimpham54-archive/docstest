<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Islandora component - Islandora CLAW</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Islandora CLAW">
    <meta property="og:image" content="None/../../">
    <meta name="apple-mobile-web-app-title" content="Islandora CLAW">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-a422ff04cc.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700|Roboto+Mono">
      <style>
        body, input {
          font-family: 'Roboto', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Technical documentation <i class="icon icon-link"></i>
              
            
          </span>
        
        Islandora component
      </div>
    </div>
    
      
      <div class="button button-twitter" role="button" aria-label="Twitter">
        <a href="https://twitter.com/islandora" title="@islandora on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
      </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/kimpham54/docstest" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          Islandora CLAW
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          kimpham54/docstest
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/kimpham54/docstest/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/kimpham54/docstest/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="../..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Alpaca</span>
    <ul>
      
        
  <li>
    <a class="" title="README" href="../../alpaca/README/">
      README
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chullo</span>
    <ul>
      
        
  <li>
    <a class="" title="CONTRIBUTING" href="../../chullo/CONTRIBUTING/">
      CONTRIBUTING
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="README" href="../../chullo/README/">
      README
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Crayfish</span>
    <ul>
      
        
  <li>
    <a class="" title="README" href="../../crayfish/README/">
      README
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Install</span>
    <ul>
      
        
  <li>
    <a class="" title="README" href="../../install/README/">
      README
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Islandora</span>
    <ul>
      
        
  <li>
    <a class="" title="README" href="../../islandora/README/">
      README
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Migration</span>
    <ul>
      
        
  <li>
    <a class="" title="Fedora namespace predicates" href="../../migration/fedora-namespace-predicates/">
      Fedora namespace predicates
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Islandora namespace predicates" href="../../migration/islandora-namespace-predicates/">
      Islandora namespace predicates
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Migration" href="../../migration/migration/">
      Migration
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Pdx</span>
    <ul>
      
        
  <li>
    <a class="" title="README" href="../../pdx/README/">
      README
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Technical documentation</span>
    <ul>
      
        
  <li>
    <a class="" title="Architecture" href="../architecture/">
      Architecture
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Commands" href="../commands/">
      Commands
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Docs build" href="../docs-build/">
      Docs build
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="Islandora component" href="./">
      Islandora component
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Introduction" href="#introduction">
                Introduction
              </a>
            </li>
          
            <li class="anchor">
              <a title="Configuration" href="#configuration">
                Configuration
              </a>
            </li>
          
            <li class="anchor">
              <a title="Usage" href="#usage">
                Usage
              </a>
            </li>
          
            <li class="anchor">
              <a title="Errors and Exceptions in PHP" href="#errors-and-exceptions-in-php">
                Errors and Exceptions in PHP
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
        
  <li>
    <a class="" title="Islandora middleware services api" href="../islandora-middleware-services-api/">
      Islandora middleware services api
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Services" href="../services/">
      Services
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Versioning" href="../versioning/">
      Versioning
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">User documentation</span>
    <ul>
      
        
  <li>
    <a class="" title="2xfor1x" href="../../user-documentation/2xfor1x/">
      2xfor1x
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Adding object to collection in islandora 7.x 2.x" href="../../user-documentation/adding-object-to-collection-in-islandora-7.x-2.x/">
      Adding object to collection in islandora 7.x 2.x
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Creating collections in islandora 7.x 2.x" href="../../user-documentation/creating-collections-in-islandora-7.x-2.x/">
      Creating collections in islandora 7.x 2.x
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Editing basic image form in islandora 7.x 2.x" href="../../user-documentation/editing-basic-image-form-in-islandora-7.x-2.x/">
      Editing basic image form in islandora 7.x 2.x
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Editing object metadata in islandora 7.x 2" href="../../user-documentation/editing-object-metadata-in-islandora-7.x-2/">
      Editing object metadata in islandora 7.x 2
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Form field select taxonomy in islandora 7.x 2.x" href="../../user-documentation/form-field-select-taxonomy-in-islandora-7.x-2.x/">
      Form field select taxonomy in islandora 7.x 2.x
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Intro to claw" href="../../user-documentation/intro-to-claw/">
      Intro to claw
    </a>
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
          <hr>
          <span class="section">The author</span>
          <ul>
            
              
              <li>
                <a href="https://twitter.com/islandora" target="_blank" title="@islandora on Twitter">
                  @islandora on Twitter
                </a>
              </li>
            
            
          </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="the-islandora-camel-component">The Islandora Camel Component</h1>
<h2 id="introduction">Introduction</h2>
<p>From within a Camel route, if you ever want to execute a command you’ve writtin in PHP, all you need to do is use the Islandora Camel Component.  The Islandora Camel Component is a very small Camel component that mimics/wraps/extends bits of camel-exec in order to streamline the use of Camel commands.  It also is responsible for evaluating the exit status of the command and bubbling up an exceptions that may have been thrown.</p>
<h2 id="configuration">Configuration</h2>
<p>Before using the Islandora component, you need to configure it in the same Blueprint xml file that defines your Camel context.  Typically, this is the <code>src/main/resources/OSGI-INF/blueprint/blueprint.xml</code> for your particular Camel project.  The component accepts a single value: the absolute path to the <code>camel/commands/bin</code> directory of your project.  It is best to set this value in the <code>islandora.cfg</code> as <code>islandora.php.workingDir</code>.</p>
<p>Assuming you're using the <code>islandora.cfg</code> file deployed to your karaf's <code>etc</code> directory, your Blueprint file will look something like this:</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;blueprint xmlns=&quot;http://www.osgi.org/xmlns/blueprint/v1.0.0&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:cm=&quot;http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.0.0&quot;
       xsi:schemaLocation=&quot;
       http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
       http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd&quot;&gt;

  &lt;!-- Load Configuration File --&gt;
  &lt;cm:property-placeholder persistent-id=&quot;islandora&quot;/&gt;

  &lt;!-- Islandora Component Configuration --&gt;
  &lt;bean id=&quot;islandora&quot; class=&quot;ca.islandora.camel.component.IslandoraComponent&quot;&gt;
    &lt;argument value=&quot;${islandora.php.workingDir}&quot;/&gt;
  &lt;/bean&gt;

  &lt;camelContext id=&quot;your_context_id&quot; xmlns=&quot;http://camel.apache.org/schema/blueprint&quot;&gt;
    &lt;-- Your routes go here... --&gt;
  &lt;/camelContext&gt;

&lt;/blueprint&gt;
</code></pre>

<h2 id="usage">Usage</h2>
<p>Once configured, you can use the component to execute any IslandoraCommand in PHP within your camel routes.  General usage is:</p>
<pre><code class="xml">&lt;to uri=&quot;islandora:namespace:command&quot;/&gt;
</code></pre>

<p>You can see a list of all available namespaces and commands at any time by going to the <code>camel/commands/bin</code> directory of your project and running <code>php islandora.php</code>.</p>
<pre><code class="bash">vagrant@islandora:~$ cd ~/islandora/camel/commands/bin
vagrant@islandora:~/islandora/camel/commands/bin$ php islandora.php
Islandora Command Tool version 0.0.0-SNAPSHOT

Usage:
  command [options] [arguments]

Options:
  -h, --help            Display this help message
  -q, --quiet           Do not output any message
  -V, --version         Display this application version
      --ansi            Force ANSI output
      --no-ansi         Disable ANSI output
  -n, --no-interaction  Do not ask any interactive question
  -v|vv|vvv, --verbose  Increase the verbosity of messages: 1 for normal output, 2 for more verbose output and 3 for debug

Available commands:
  help                            Displays help for a command
  list                            Lists commands
 collectionService
  collectionService:nodeToSparql  Converts Drupal node JSON for a collection to a SPARQL Update query
 greeter
  greeter:hello                   Says hello!
  greeter:helloUsingJson          Says hello!  Accepts JSON data in the form {&quot;name&quot; : &quot;your_name&quot;}.
 rdf
  rdf:createNode                  Creates a Drupal node from Fedora RDF.
  rdf:extractContentType          Extracts a Drupal content type from Fedora RDF.
  rdf:updateNode                  Updates a Drupal node from Fedora RDF.
</code></pre>

<p>For example, to run the greeter example from the tutorial in the Commands documentation:</p>
<pre><code class="xml">&lt;to uri=&quot;islandora:greeter:hello&quot;/&gt;
</code></pre>

<p>Here's a small Blueprint file that will execute the <code>greeter:hello</code> command every 5 seconds and log the output.</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;blueprint xmlns=&quot;http://www.osgi.org/xmlns/blueprint/v1.0.0&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:cm=&quot;http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.0.0&quot;
       xsi:schemaLocation=&quot;
       http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
       http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd&quot;&gt;

  &lt;!-- Load Configuration File --&gt;
  &lt;cm:property-placeholder persistent-id=&quot;islandora&quot;/&gt;

  &lt;!-- Islandora Component Configuration --&gt;
  &lt;bean id=&quot;islandora&quot; class=&quot;ca.islandora.camel.component.IslandoraComponent&quot;&gt;
    &lt;argument value=&quot;${islandora.php.workingDir}&quot;/&gt;
  &lt;/bean&gt;

  &lt;camelContext id=&quot;your_context_id&quot; xmlns=&quot;http://camel.apache.org/schema/blueprint&quot;&gt;
    &lt;route&gt;
      &lt;from uri=&quot;timer:foo?period=5000&quot;/&gt;
        &lt;setBody&gt;&lt;constant&gt;World&lt;/constant&gt;&lt;/setBody&gt;
        &lt;to uri=&quot;islandora:greeter:hello&quot;/&gt;
        &lt;log message=&quot;${body}&quot;/&gt;
    &lt;/route&gt;
  &lt;/camelContext&gt;

&lt;/blueprint&gt;
</code></pre>

<p>You can deploy this file to your karaf's <code>deploy</code> directory and watch it go.  In your logs, you should see something like this:</p>
<pre><code class="bash">vagrant@islandora:~$ /opt/karaf/bin/client
Logging in as karaf
750 [sshd-SshClient[6107227e]-nio2-thread-1] WARN org.apache.sshd.client.keyverifier.AcceptAllServerKeyVerifier - Server at [/0.0.0.0:8101, RSA, 88:ab:a4:c9:c0:bc:53:bf:bb:f8:b3:8b:80:98:26:7d] presented unverified {} key: {}
        __ __                  ____
       / //_/____ __________ _/ __/
      / ,&lt;  / __ `/ ___/ __ `/ /_
     / /| |/ /_/ / /  / /_/ / __/
    /_/ |_|\__,_/_/   \__,_/_/

  Apache Karaf (3.0.4)

Hit '&lt;tab&gt;' for a list of available commands
and '[cmd] --help' for help on a specific command.
Hit 'system:shutdown' to shutdown Karaf.
Hit '&lt;ctrl-d&gt;' or type 'logout' to disconnect shell from current session.

karaf@root()&gt; log:tail
2015-07-17 18:12:51,292 | INFO  | #7 - timer://foo | IslandoraProducer                | 132 - ca.islandora.camel.component.islandora-camel-component - 0.0.0.SNAPSHOT | Executing ExecCommand [args=[islandora.php, greeter:hello], executable=php, timeout=9223372036854775807, outFile=null, workingDir=/home/vagrant/islandora/camel/commands/bin, useStderrOnEmptyStdout=false]
2015-07-17 18:12:51,681 | INFO  | #7 - timer://foo | IslandoraProducer                | 132 - ca.islandora.camel.component.islandora-camel-component - 0.0.0.SNAPSHOT | The command ExecCommand [args=[islandora.php, greeter:hello], executable=php, timeout=9223372036854775807, outFile=null, workingDir=/home/vagrant/islandora/camel/commands/bin, useStderrOnEmptyStdout=false] had exit value 0
2015-07-17 18:12:51,682 | INFO  | #7 - timer://foo | route53                          | 109 - org.apache.camel.camel-core - 2.15.2 | Hello World!

2015-07-17 18:12:56,292 | INFO  | #7 - timer://foo | IslandoraProducer                | 132 - ca.islandora.camel.component.islandora-camel-component - 0.0.0.SNAPSHOT | Executing ExecCommand [args=[islandora.php, greeter:hello], executable=php, timeout=9223372036854775807, outFile=null, workingDir=/home/vagrant/islandora/camel/commands/bin, useStderrOnEmptyStdout=false]
2015-07-17 18:12:56,676 | INFO  | #7 - timer://foo | IslandoraProducer                | 132 - ca.islandora.camel.component.islandora-camel-component - 0.0.0.SNAPSHOT | The command ExecCommand [args=[islandora.php, greeter:hello], executable=php, timeout=9223372036854775807, outFile=null, workingDir=/home/vagrant/islandora/camel/commands/bin, useStderrOnEmptyStdout=false] had exit value 0
2015-07-17 18:12:56,676 | INFO  | #7 - timer://foo | route53                          | 109 - org.apache.camel.camel-core - 2.15.2 | Hello World!
</code></pre>

<h2 id="errors-and-exceptions-in-php">Errors and Exceptions in PHP</h2>
<p>The Islandora Camel component automatically handles checking the return code on the command, and will automatically bubble up any exception from PHP by throwing an IslandoraPHPException that can be handled within your Camel context.  See the section on exception handling in Camel for more information.</p>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../docs-build/" title="Docs build">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Docs build
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../islandora-middleware-services-api/" title="Islandora middleware services api">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Islandora middleware services api
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'kimpham54/docstest';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
    
  </body>
</html>